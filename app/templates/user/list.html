{% extends "layouts/base.html" %}
{% block title %}ç”¨æˆ·ç®¡ç†{% endblock %}

{% block content %}
<div class="card">
    <div class="flex justify-between items-center mb-4">
        <div class="card-title">ğŸ‘¥ ç”¨æˆ·ç®¡ç†</div>
        <a href="{{ url_for('user.user_create') }}" class="btn btn-primary">+ æ–°å»ºç”¨æˆ·</a>
    </div>

    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>ç”¨æˆ·å</th>
                    <th>å§“å</th>
                    <th>è§’è‰²</th>
                    <th>æŸ¥çœ‹è®¢å•</th>
                    <th>å‘è´§</th>
                    <th>é€€æ¬¾</th>
                    <th>çŠ¶æ€</th>
                    <th>æœ€åç™»å½•</th>
                    <th>æ“ä½œ</th>
                </tr>
            </thead>
            <tbody>
                {% for u in users %}
                <tr>
                    <td>{{ u.username }}</td>
                    <td>{{ u.name or '-' }}</td>
                    <td>
                        {% if u.role == 'admin' %}
                        <span class="badge badge-info">ç®¡ç†å‘˜</span>
                        {% else %}
                        <span class="badge badge-default">æ“ä½œå‘˜</span>
                        {% endif %}
                    </td>
                    <td>{{ 'âœ…' if u.is_admin or u.can_view_order else 'âŒ' }}</td>
                    <td>{{ 'âœ…' if u.is_admin or u.can_deliver else 'âŒ' }}</td>
                    <td>{{ 'âœ…' if u.is_admin or u.can_refund else 'âŒ' }}</td>
                    <td>
                        {% if u.is_active %}
                        <span class="badge badge-success">æ¿€æ´»</span>
                        {% else %}
                        <span class="badge badge-danger">ç¦ç”¨</span>
                        {% endif %}
                    </td>
                    <td>{{ u.last_login.strftime('%m-%d %H:%M') if u.last_login else '-' }}</td>
                    <td>
                        <a href="{{ url_for('user.user_edit', user_id=u.id) }}" class="btn btn-sm">ç¼–è¾‘</a>
                        {% if u.id != current_user.id %}
                        <form method="POST" action="{{ url_for('user.user_delete', user_id=u.id) }}" style="display:inline;"
                              onsubmit="return confirm('ç¡®è®¤åˆ é™¤æ­¤ç”¨æˆ·ï¼Ÿ')">
                            <button type="submit" class="btn btn-sm btn-danger">åˆ é™¤</button>
                        </form>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
