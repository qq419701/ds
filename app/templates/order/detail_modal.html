<div class="card" style="width: 100%; max-width: 100%; margin: 0; padding: 20px; box-sizing: border-box; background: white;">
    <div class="card-title">
        ğŸ“„ è®¢å•è¯¦æƒ…
    </div>

    <div class="detail-section">
        <h3>ğŸ“‹ åŸºæœ¬ä¿¡æ¯</h3>
        <div class="detail-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px 60px; width: 100%;">
            <div class="detail-item">
                <label>ç³»ç»Ÿè®¢å•å·ï¼š</label>
                <span>{{ order.order_no }}</span>
            </div>
            <div class="detail-item">
                <label>äº¬ä¸œè®¢å•å·ï¼š</label>
                <span>{{ order.jd_order_no }}</span>
            </div>
            <div class="detail-item">
                <label>åº—é“ºåç§°ï¼š</label>
                <span>{{ order.shop.shop_name if order.shop else 'æœªçŸ¥' }}</span>
            </div>
            <div class="detail-item">
                <label>è®¢å•ç±»å‹ï¼š</label>
                <span>
                    {% if order.shop_type == 1 %}
                        <span class="badge badge-info">æ¸¸æˆç‚¹å¡</span>
                    {% else %}
                        <span class="badge badge-success">é€šç”¨äº¤æ˜“</span>
                    {% endif %}
                    -
                    {% if order.order_type == 1 %}
                        <span class="badge badge-primary">ç›´å……</span>
                    {% else %}
                        <span class="badge badge-warning">å¡å¯†</span>
                    {% endif %}
                </span>
            </div>
            <div class="detail-item">
                <label>è®¢å•çŠ¶æ€ï¼š</label>
                <span>
                    {% if order.order_status == 0 %}
                        <span class="badge badge-warning">â³ å¾…å¤„ç†</span>
                    {% elif order.order_status == 1 %}
                        <span class="badge badge-info">ğŸ”„ å¤„ç†ä¸­</span>
                    {% elif order.order_status == 2 %}
                        <span class="badge badge-success">âœ… å·²å®Œæˆ</span>
                    {% elif order.order_status == 3 %}
                        <span class="badge badge-secondary">âŒ å·²å–æ¶ˆ</span>
                    {% elif order.order_status == 4 %}
                        <span class="badge badge-danger">ğŸ’° å·²é€€æ¬¾</span>
                    {% elif order.order_status == 5 %}
                        <span class="badge badge-error">âš ï¸ å¼‚å¸¸</span>
                    {% endif %}
                </span>
            </div>
            <div class="detail-item">
                <label>å•†å“ä¿¡æ¯ï¼š</label>
                <span>{{ order.product_info or '-' }}</span>
            </div>
            <div class="detail-item">
                <label>SKU IDï¼š</label>
                <span>{{ order.sku_id or '-' }}</span>
            </div>
            <div class="detail-item">
                <label>è®¢å•é‡‘é¢ï¼š</label>
                <span class="amount">Â¥{{ '%.2f'|format(order.amount / 100) }}</span>
            </div>
            <div class="detail-item">
                <label>è®¢å•æ•°é‡ï¼š</label>
                <span>{{ order.quantity }}</span>
            </div>
            <div class="detail-item">
                <label>å……å€¼è´¦å·ï¼š</label>
                <span>{{ order.produce_account or '-' }}</span>
            </div>
            <div class="detail-item">
                <label>åˆ›å»ºæ—¶é—´ï¼š</label>
                <span>{{ order.create_time.strftime('%Y-%m-%d %H:%M:%S') }}</span>
            </div>
            <div class="detail-item">
                <label>å¤‡æ³¨ï¼š</label>
                <span>{{ order.remark or '-' }}</span>
            </div>
        </div>
    </div>

    <!-- å¡å¯†è®¢å•ï¼šæ˜¾ç¤ºæˆ–å¡«å†™å¡å¯† -->
    {% if order.order_type == 2 %}
    <div class="detail-section">
        <h3>ğŸ’³ å¡å¯†ä¿¡æ¯</h3>
        
        {% if order.card_info_parsed %}
            <!-- å·²æœ‰å¡å¯†ï¼Œæ˜¾ç¤ºåˆ—è¡¨ -->
            <div class="card-list-container">
                <table class="card-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>å¡å·</th>
                            <th>å¯†ç </th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for card in order.card_info_parsed %}
                        <tr>
                            <td>{{ loop.index }}</td>
                            <td>{{ card.cardNo }}</td>
                            <td>{{ card.cardPwd }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            <!-- æœªå¡«å†™å¡å¯†ï¼Œæ˜¾ç¤ºå¡«å†™è¡¨å• -->
            <div class="alert alert-warning">
                âš ï¸ è¯¥è®¢å•éœ€è¦ <strong>{{ order.quantity }}</strong> ç»„å¡å¯†ï¼Œè¯·å¡«å†™åæäº¤
            </div>
            
            <div class="card-input-tools mb-3">
                <button type="button" class="btn btn-primary" onclick="generateRandomCards({{ order.quantity }})">
                    ğŸ² ä¸€é”®ç”Ÿæˆéšæœºå¡å¯†ï¼ˆ{{ order.quantity }}ç»„ï¼‰
                </button>
                <button type="button" class="btn" onclick="clearAllCards({{ order.quantity }})">
                    ğŸ—‘ï¸ æ¸…ç©ºå…¨éƒ¨
                </button>
            </div>
            
            <form id="cardForm" onsubmit="submitCards(event)" data-order-id="{{ order.id }}" data-quantity="{{ order.quantity }}">
                <div id="cardInputs">
                    {% for i in range(order.quantity) %}
                    <div class="card-input-row">
                        <span class="card-index">ç¬¬ {{ i+1 }} ç»„ï¼š</span>
                        <input type="text" 
                               class="form-control card-no" 
                               name="cardNo_{{ i }}" 
                               placeholder="å¡å·" 
                               required 
                               
                               >
                        <input type="text" 
                               class="form-control card-pwd" 
                               name="cardPwd_{{ i }}" 
                               placeholder="å¯†ç " 
                               required 
                               
                               >
                    </div>
                    {% endfor %}
                </div>
                
                <div class="mt-4">
                    <button type="submit" class="btn btn-success">ğŸ’¾ ä¿å­˜å¡å¯†</button>
                </div>
            </form>
        {% endif %}
    </div>
    {% endif %}

    <!-- æ“ä½œæ—¥å¿— -->
    <div class="detail-section">
        <h3>ğŸ“œ æ“ä½œæ—¥å¿—</h3>
        <div class="log-container">
            <div class="log-item">
                <span class="log-time">{{ order.create_time.strftime('%Y-%m-%d %H:%M:%S') }}</span>
                <span class="log-content">è®¢å•åˆ›å»º</span>
            </div>
            {% if order.card_info_parsed %}
            <div class="log-item">
                <span class="log-time">-</span>
                <span class="log-content">å·²å¡«å†™ {{ order.card_info_parsed|length }} ç»„å¡å¯†</span>
            </div>
            {% endif %}
        </div>
    </div>
</div>

